

(($) ->

  $.fn.shorten = (settings) ->
    config =
      showChars: 100
      ellipsesText: '...'
      moreText: 'more'
      lessText: 'less'
    if settings
      $.extend config, settings
    $(document).off 'click', '.morelink'
    $(document).on { click: ->
      $this = $(this)
      if $this.hasClass('less')
        $this.removeClass 'less'
        $this.html config.moreText
      else
        $this.addClass 'less'
        $this.html config.lessText
      $this.parent().prev().toggle()
      $this.prev().toggle()
      false
 }, '.morelink'
    @each ->
      $this = $(this)
      if $this.hasClass('shortened')
        return
      $this.addClass 'shortened'
      content = $this.html()
      if content.length > config.showChars
        c = content.substr(0, config.showChars)
        h = content.substr(config.showChars, content.length - (config.showChars))
        html = c + '<span class="moreellipses">' + config.ellipsesText + ' </span><span class="morecontent"><span>' + h + '</span> <a href="#" class="morelink">' + config.moreText + '</a></span>'
        $this.html html
        $('.morecontent span').hide()
      return

  return
) jQuery

# ---
# generated by js2coffee 2.2.0
